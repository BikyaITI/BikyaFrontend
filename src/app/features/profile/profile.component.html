<div class="container mt-4">
  <div class="row">
    <!-- Profile Sidebar -->
    <div class="col-md-4">
      <div class="card shadow-sm">
        <div class="card-body text-center">
          <div class="profile-avatar mb-3">
            <div class="bg-primary rounded-circle d-flex align-items-center justify-content-center mx-auto"
              style="width: 120px; height: 120px;">
              <i class="bi bi-person-fill text-white" style="font-size: 4rem;"></i>
            </div>
          </div>
          <h4 class="mb-1">{{currentUser?.fullName}}</h4>
          <p class="text-muted mb-3">{{currentUser?.email}}</p>
          <div class="d-grid gap-2">
            <!-- Overview -->
            <button class="btn" [ngClass]="{
  'btn-primary': activeTab === 'overview',
  'btn-outline-primary': activeTab !== 'overview'
}" (click)="setActiveTab('overview')">
              <i class="bi bi-person-circle"></i> Profile Overview
            </button>

            <!-- Edit Profile -->
            <button class="btn" [ngClass]="{
  'btn-secondary': activeTab === 'editProfile',
  'btn-outline-seondary': activeTab !== 'editProfile'
}" (click)="setActiveTab('editProfile')">
              <i class="bi bi-person"></i> Edit Profile
            </button>

            <!-- Change Password -->
            <button class="btn" [ngClass]="{
  'btn-warning': activeTab === 'password',
  'btn-outline-warning': activeTab !== 'password'
}" (click)="setActiveTab('password')">
              <i class="bi bi-lock"></i> Change Password
            </button>

            <!-- Account Settings -->
            <button class="btn" [ngClass]="{
  'btn-danger': activeTab === 'account',
  'btn-outline-danger': activeTab !== 'account'
}" (click)="setActiveTab('account')">
              <i class="bi bi-gear"></i> Account Settings
            </button>

          </div>
        </div>
      </div>

      <!-- Quick Stats -->
      <div class="card shadow-sm mt-3">
        <div class="card-header">
          <h6 class="mb-0"><i class="bi bi-graph-up"></i> Account Stats</h6>
        </div>
        <div class="card-body">
          <div class="row text-center">
            <div class="col-6">
              <h4 class="text-primary mb-0">{{userStats.totalProducts}}</h4>
              <small class="text-muted">Products</small>
            </div>
            <div class="col-6">
              <h4 class="text-success mb-0">{{userStats.totalOrders}}</h4>
              <small class="text-muted">Orders</small>
            </div>
          </div>
          <hr>
          <div class="row text-center">
            <div class="col-6">
              <h4 class="text-info mb-0">{{userStats.totalSales}}</h4>
              <small class="text-muted">Sales</small>
            </div>
            <div class="col-6">
              <h4 class="text-warning mb-0">{{averageRating}}</h4>
              <small class="text-muted">Rating</small>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Tab Contents -->
    <!-- Default Profile View (When no tab is selected) -->


    <div class="col-md-8">

      <div class="card shadow-sm" *ngIf="activeTab === 'overview'">
        <div class="card-body text-center">
          <h5 class="mb-3">Welcome to your profile!</h5>
          <p class="text-muted mb-4">You can manage your account using the buttons on the left.</p>

          <div class="d-flex flex-wrap justify-content-center gap-3 mt-4">
            <button class="btn btn-outline-secondary" (click)="navigateToMyProducts()">
              <i class="bi bi-box"></i> My Products
            </button>
            <button class="btn btn-success" (click)="navigateToAddProduct()">
              <i class="bi bi-plus-circle"></i> Add Product
            </button>
            <button class="btn btn-info" (click)="navigateToOrders()">
              <i class="bi bi-box-seam"></i> View Orders
            </button>
          </div>
        </div>
        <div>
          <hr class="w-50 mx-auto text-secondary">
        </div>
        <div class="card-body text-center">
          <h5><i class="bi bi-star-fill text-warning"></i> My Reviews</h5>
          <app-review [sellerId]="currentUser?.id"></app-review>

        </div>

      </div>
      <!-- Profile Edit Tab -->
      <div class="card shadow-sm" *ngIf="activeTab === 'editProfile'">
        <div class="card-header">
          <h5 class="mb-0"><i class="bi bi-person"></i> Edit Profile</h5>
        </div>
        <div class="card-body">
          <form [formGroup]="profileForm" (ngSubmit)="updateProfile()">
            <div class="row">
              <div class="col-md-6 mb-3">
                <label for="fullName" class="form-label">Full Name *</label>
                <input type="text" class="form-control" id="fullName" formControlName="fullName"
                  [class.is-invalid]="profileForm.get('fullName')?.invalid && profileForm.get('fullName')?.touched">
                <div class="invalid-feedback">
                  Full name is required
                </div>
              </div>

              <div class="col-md-6 mb-3">
                <label for="email" class="form-label">Email *</label>
                <input type="email" class="form-control" id="email" formControlName="email"
                  [class.is-invalid]="profileForm.get('email')?.invalid && profileForm.get('email')?.touched">
                <div class="invalid-feedback">
                  Valid email is required
                </div>
              </div>
            </div>

            <div class="mb-3">
              <label for="phone" class="form-label">Phone Number</label>
              <input type="tel" class="form-control" id="phone" formControlName="phone"
                placeholder="Enter your phone number">
            </div>

            <div class="mb-3">
              <label for="bio" class="form-label">Bio</label>
              <textarea class="form-control" id="bio" formControlName="bio" rows="4"
                placeholder="Tell us about yourself..." maxlength="500"></textarea>
              <div class="form-text">
                {{profileForm.get('bio')?.value?.length || 0}}/500 characters
              </div>
            </div>

            <div class="alert alert-success" *ngIf="profileSuccessMessage">
              <i class="bi bi-check-circle"></i> {{profileSuccessMessage}}
            </div>

            <div class="alert alert-danger" *ngIf="profileErrorMessage">
              <i class="bi bi-exclamation-triangle"></i> {{profileErrorMessage}}
            </div>

            <button type="submit" class="btn btn-primary" [disabled]="profileForm.invalid || isUpdatingProfile">
              <span *ngIf="isUpdatingProfile" class="spinner-border spinner-border-sm me-2"></span>
              {{isUpdatingProfile ? 'Updating...' : 'Update Profile'}}
            </button>
          </form>
        </div>
      </div>

      <!-- Change Password Tab -->
      <div class="card shadow-sm" *ngIf="activeTab === 'password'">
        <div class="card-header">
          <h5 class="mb-0"><i class="bi bi-lock"></i> Change Password</h5>
        </div>
        <div class="card-body">
          <form [formGroup]="passwordForm" (ngSubmit)="changePassword()">
            <div class="mb-3">
              <label for="currentPassword" class="form-label">Current Password *</label>
              <input type="password" class="form-control" id="currentPassword" formControlName="currentPassword"
                [class.is-invalid]="passwordForm.get('currentPassword')?.invalid && passwordForm.get('currentPassword')?.touched">
              <div class="invalid-feedback">
                Current password is required
              </div>
            </div>

            <div class="mb-3">
              <label for="newPassword" class="form-label">New Password *</label>
              <input type="password" class="form-control" id="newPassword" formControlName="newPassword"
                [class.is-invalid]="passwordForm.get('newPassword')?.invalid && passwordForm.get('newPassword')?.touched">
              <div class="invalid-feedback">
                Password must be at least 6 characters long
              </div>
            </div>

            <div class="mb-3">
              <label for="confirmPassword" class="form-label">Confirm New Password *</label>
              <input type="password" class="form-control" id="confirmPassword" formControlName="confirmPassword"
                [class.is-invalid]="passwordForm.get('confirmPassword')?.invalid && passwordForm.get('confirmPassword')?.touched">
              <div class="invalid-feedback">
                Passwords do not match
              </div>
            </div>

            <div class="alert alert-success" *ngIf="passwordSuccessMessage">
              <i class="bi bi-check-circle"></i> {{passwordSuccessMessage}}
            </div>

            <div class="alert alert-danger" *ngIf="passwordErrorMessage">
              <i class="bi bi-exclamation-triangle"></i> {{passwordErrorMessage}}
            </div>

            <button type="submit" class="btn btn-warning" [disabled]="passwordForm.invalid || isChangingPassword">
              <span *ngIf="isChangingPassword" class="spinner-border spinner-border-sm me-2"></span>
              {{isChangingPassword ? 'Changing...' : 'Change Password'}}
            </button>
          </form>
        </div>
      </div>

      <!-- Account Settings Tab -->
      <div class="card shadow-sm" *ngIf="activeTab === 'account'">
        <div class="card-header">
          <h5 class="mb-0"><i class="bi bi-gear"></i> Account Settings</h5>
        </div>
        <div class="card-body">
          <div class="settings-section mb-4">
            <h6 class="text-primary">Notifications</h6>
            <div class="form-check form-switch mb-2">
              <input class="form-check-input" type="checkbox" id="emailNotifications" checked>
              <label class="form-check-label" for="emailNotifications">
                Email Notifications
              </label>
            </div>
            <div class="form-check form-switch mb-2">
              <input class="form-check-input" type="checkbox" id="orderUpdates" checked>
              <label class="form-check-label" for="orderUpdates">
                Order Updates
              </label>
            </div>
            <div class="form-check form-switch mb-2">
              <input class="form-check-input" type="checkbox" id="marketingEmails">
              <label class="form-check-label" for="marketingEmails">
                Marketing Emails
              </label>
            </div>
          </div>

          <div class="settings-section mb-4">
            <h6 class="text-primary">Privacy</h6>
            <div class="form-check form-switch mb-2">
              <input class="form-check-input" type="checkbox" id="profileVisibility" checked>
              <label class="form-check-label" for="profileVisibility">
                Make Profile Public
              </label>
            </div>
            <div class="form-check form-switch mb-2">
              <input class="form-check-input" type="checkbox" id="showOnlineStatus">
              <label class="form-check-label" for="showOnlineStatus">
                Show Online Status
              </label>
            </div>
          </div>

          <div class="settings-section">
            <h6 class="text-danger">Danger Zone</h6>
            <p class="text-muted">These actions cannot be undone</p>
            <button class="btn btn-outline-danger" (click)="deactivateAccount()">
              <i class="bi bi-exclamation-triangle"></i> Deactivate Account
            </button>
          </div>
        </div>
      </div>
    </div>

  </div>