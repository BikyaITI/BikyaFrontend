<div class="body">
   <div class="container mt-4">
      <div class="row justify-content-center">
        <div class="col-lg-8">
          <div class="card shadow">
            <div class="card-header bg-primary text-white">
              <h3 class="mb-0 text-white"><i class="bi bi-plus-circle"></i> Add New Product</h3>
            </div>
            <div class="card-body">
              <form [formGroup]="productForm" (ngSubmit)="onSubmit()">
                <!-- Basic Information -->
                <div class="section-header mb-4">
                  <h5 class="text-primary"><i class="bi bi-info-circle"></i> Basic Information</h5>
                  <hr>
                </div>

                <div class="row">
                  <div class="col-md-8 mb-3">
                    <label for="title" class="form-label">Product Title *</label>
                    <input
                      type="text"
                      class="form-control"
                      id="title"
                      formControlName="title"
                      placeholder="Enter product title"
                      [class.is-invalid]="productForm.get('title')?.invalid && productForm.get('title')?.touched">
                    <div class="invalid-feedback">
                      Product title is required
                    </div>
                  </div>

                  <div class="col-md-4 mb-3">
                    <label for="price" class="form-label">Price (EGP) *</label>
                    <div class="input-group">
                      <span class="input-group-text">EGP</span>
                      <input
                        type="number"
                        class="form-control"
                        id="price"
                        formControlName="price"
                        placeholder="0.00"
                        step="0.01"
                        [class.is-invalid]="productForm.get('price')?.invalid && productForm.get('price')?.touched">
                      <div class="invalid-feedback">
                        Valid price is required
                      </div>
                    </div>
                  </div>
                </div>

                <div class="mb-3">
                  <label for="description" class="form-label">Description *</label>
                  <textarea
                    class="form-control"
                    id="description"
                    formControlName="description"
                    rows="4"
                    placeholder="Describe your product in detail..."
                    [class.is-invalid]="productForm.get('description')?.invalid && productForm.get('description')?.touched"></textarea>
                  <div class="invalid-feedback">
                    Product description is required
                  </div>
                  <div class="form-text">
                    <span [class]="getDescriptionCountClass()">
                      {{productForm.get('description')?.value?.length || 0}}/500 characters
                    </span>
                  </div>
                </div>

                <!-- Category and Condition -->
                <div class="section-header mb-4 mt-4">
                  <h5 class="text-primary"><i class="bi bi-tags"></i> Category & Condition</h5>
                  <hr>
                </div>

                <div class="row">
                  <div class="col-md-6 mb-3">
                    <label for="categoryId" class="form-label">Category *</label>
                    <select
                      class="form-select"
                      id="categoryId"
                      formControlName="categoryId"
                      [class.is-invalid]="productForm.get('categoryId')?.invalid && productForm.get('categoryId')?.touched">
                      <option value="">Select a category</option>
                      <option *ngFor="let category of categories" [value]="category.id">
                        {{category.name}}
                      </option>
                    </select>
                    <div class="invalid-feedback">
                      Please select a category
                    </div>
                  </div>

                  <div class="col-md-6 mb-3">
                    <label for="condition" class="form-label">Condition *</label>
                    <select
                      class="form-select"
                      id="condition"
                      formControlName="condition"
                      [class.is-invalid]="productForm.get('condition')?.invalid && productForm.get('condition')?.touched">
                      <option value="">Select condition</option>
                      <option value="new">New</option>
                      <option value="used">Used</option>
                    
                    </select>
                    <div class="invalid-feedback">
                      Please select condition
                    </div>
                  </div>
                </div>

                <!-- Exchange Option -->
                <div class="section-header mb-4 mt-4">
                  <h5 class="text-primary"><i class="bi bi-arrow-left-right"></i> Exchange Options</h5>
                  <hr>
                </div>

                <div class="mb-3">
                  <div class="form-check form-switch">
                    <input
                      class="form-check-input"
                      type="checkbox"
                      id="isForExchange"
                      formControlName="isForExchange">
                    <label class="form-check-label" for="isForExchange">
                      <strong>Allow Exchange</strong>
                      <div class="form-text">Enable this if you're willing to exchange this item for other products</div>
                    </label>
                  </div>
                </div>

                <!-- Images -->
                <div class="section-header mb-4 mt-4">
                  <h5 class="text-primary"><i class="bi bi-images"></i> Product Images</h5>
                  <hr>
                </div>

                <div class="mb-3">
                  <label for="mainImage" class="form-label">Main Image *</label>
                  <input
                    type="file"
                    class="form-control"
                    id="mainImage"
                    (change)="onMainImageSelected($event)"
                    accept="image/*"
                    [class.is-invalid]="!mainImage && submitted">
                  <div class="invalid-feedback">
                    Main image is required
                  </div>
                  <div class="form-text">Upload the main image for your product (JPG, PNG, max 5MB)</div>

                  <!-- Main Image Preview -->
                  <div class="mt-2" *ngIf="mainImagePreview">
                    <img [src]="mainImagePreview" class="img-thumbnail" style="max-width: 200px; max-height: 200px;">
                  </div>
                </div>

                <div class="mb-3">
                  <label for="additionalImages" class="form-label">Additional Images (Optional)</label>
                  <input
                    type="file"
                    class="form-control"
                    id="additionalImages"
                    (change)="onAdditionalImagesSelected($event)"
                    accept="image/*"
                    multiple>
                  <div class="form-text">Upload up to 4 additional images (JPG, PNG, max 5MB each)</div>

                  <!-- Additional Images Preview -->
                  <div class="row mt-2" *ngIf="additionalImagePreviews.length > 0">
                    <div class="col-3" *ngFor="let preview of additionalImagePreviews; let i = index">
                      <div class="position-relative">
                        <img [src]="preview" class="img-thumbnail w-100" style="height: 100px; object-fit: cover;">
                        <button
                          type="button"
                          class="btn btn-danger btn-sm position-absolute top-0 end-0"
                          (click)="removeAdditionalImage(i)"
                          style="transform: translate(25%, -25%);">
                          <i class="bi bi-x"></i>
                        </button>
                      </div>
                    </div>
                  </div>
                </div>

                <!-- Error Messages -->
                <div class="alert alert-danger" *ngIf="errorMessage">
                  <i class="bi bi-exclamation-triangle"></i> {{errorMessage}}
                </div>

                <!-- Success Message -->
                <div class="alert alert-success" *ngIf="successMessage">
                  <i class="bi bi-check-circle"></i> {{successMessage}}
                </div>

                <!-- Form Actions -->
                <div class="d-flex justify-content-between mt-4">
                  <button type="button" class="btn btn-outline-secondary" (click)="goBack()">
                    <i class="bi bi-arrow-left"></i> Cancel
                  </button>
                  <button
                    type="submit"
                    class="btn btn-primary btn-lg"
                    [disabled]="productForm.invalid || isSubmitting">
                    <span *ngIf="isSubmitting" class="spinner-border spinner-border-sm me-2"></span>
                    <i class="bi bi-plus-circle" *ngIf="!isSubmitting"></i>
                    {{isSubmitting ? 'Adding Product...' : 'Add Product'}}
                  </button>
                </div>
              </form>
            </div>
          </div>
        </div>
      </div>
    </div>
</div>