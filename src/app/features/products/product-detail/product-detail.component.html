 <div class="container mt-4" *ngIf="product">
      <nav aria-label="breadcrumb">
        <ol class="breadcrumb">
          <li class="breadcrumb-item"><a routerLink="/">Home</a></li>
          <li class="breadcrumb-item"><a routerLink="/products">Products</a></li>
          <li class="breadcrumb-item active">{{product.title}}</li>
        </ol>
      </nav>

      <div class="row">
        <!-- Product Images -->
        <div class="col-lg-6">
          <div class="product-gallery">
            <div class="main-image mb-3">
              <img
                [src]="selectedImage"
                [alt]="product.title"
                class="img-fluid rounded shadow-sm w-100"
                style="height: 400px; object-fit: cover;">
            </div>

            <div class="thumbnail-images" *ngIf="product.images && product.images.length > 1">
              <div class="row g-2">
                <div class="col-3" *ngFor="let image of product.images">
                  <img
                    [src]="GetImage(image.imageUrl)"
                    [alt]="product.title"
                    class="img-fluid rounded cursor-pointer thumbnail"
                    [class.active]="selectedImage === image.imageUrl"
                    (click)="selectImage(image.imageUrl)"
                    style="height: 80px; object-fit: cover;">
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Product Info -->
        <div class="col-lg-6">
          <div class="product-info">
            <div class="d-flex justify-content-between align-items-start mb-3">
              <h1 class="h2 mb-0">{{product.title}}</h1>
              <div class="badges">
                <span class="badge bg-success me-2" *ngIf="product.isForExchange">
                  <i class="bi bi-arrow-left-right"></i> Exchange Available
                </span>
                <!-- <span class="badge bg-info">{{product.condition}}</span> -->
              </div>
            </div>

            <div class="price-section mb-4">
              <h3 class="text-primary mb-0"> {{product.price | number:'1.'}} EGP</h3>
           
            </div>

            <div class="seller-info mb-4">
              <div class="d-flex align-items-center">
                <div class="avatar me-3">
                  <div class="bg-primary rounded-circle d-flex align-items-center justify-content-center"
                       style="width: 50px; height: 50px;">
                    <i class="bi bi-person-fill text-white fs-4"></i>
                  </div>
                </div>
                <div>
                  <h6 class="mb-0">{{product.userName || 'Unknown Seller'}}</h6>
                  <small class="text-muted">
                    <i class="bi bi-calendar3"></i>
                    Listed {{product.createdAt | date:'mediumDate'}}
                  </small>
                </div>
              </div>
            </div>

            <div class="description mb-4">
              <h5>Description</h5>
              <p class="text-muted">{{product.description}}</p>
            </div>

            <div class="product-details mb-4">
              <h5>Details</h5>
              <div class="row">
                <div class="col-6">
                  <strong>Category:</strong>
                  <span class="badge bg-light text-dark ms-2">{{product.categoryName}}</span>
                </div>
                <div class="col-6">
                  <strong>Condition:</strong>
                  <span class="ms-2 badge " [class]="getConditionBadgeClass(product.condition)">{{product.condition}}</span>
                </div>
              </div>
            </div>

            <!-- Action Buttons -->
<!-- *ngIf="currentUser && currentUser.id !== product.userId" -->
            <div class="action-buttons"  >
              <div class="row g-2">
                <div class="col-md-6">
                  <button
                    class="btn btn-primary btn-lg w-100"
                    data-bs-toggle="modal"
                    data-bs-target="#orderModal">
                    <i class="bi bi-cart-plus"></i> Buy Now
                  </button>
                </div>
                <div class="col-md-6" >
                  <button
                    class="btn btn-outline-primary btn-lg w-100"
                    data-bs-toggle="modal"
                    data-bs-target="#exchangeModal"
                     [disabled]="!product.isForExchange">
                    <i class="bi bi-arrow-left-right"></i> Propose Exchange
                  </button>
                </div>
              </div>

              <div class="row g-2 mt-2">
                <div class="col-md-6">
                  <button class="btn btn-outline-danger w-100 mb-3"(click)="AddToWishlist()">
                    <i class="bi bi-heart"></i> Add to Wishlist
                  </button>
                </div>
                <div class="col-md-6">
                </div>
              </div>
            </div>

            <!-- Owner Actions -->
<!-- *ngIf="currentUser && currentUser.id === product.userId" -->
            <div class="owner-actions" >
             
              <div class="row g-2">
                <div class="col-6">
                  <button class="btn btn-warning w-100"(click)="EditProduct()">
                    <i class="bi bi-pencil"></i> Edit
                  </button>
                </div>
                <div class="col-6">
                  <button class="btn btn-danger w-100" (click)="deleteProduct()">
                    <i class="bi bi-trash"></i> Delete
                  </button>
                </div>
              </div>
            </div>

              <!-- admin Actions -->
<!-- *ngIf="currentUser && currentUser.role === 'admin'" -->
            <div class="owner-actions" >
             
              <div class="row g-2">
                <div class="col-6">
                  <button class="btn btn-warning w-100"(click)="EditProduct()" [disabled]="product.isApproved">
                    <i class="bi bi-pencil"></i> Approve
                  </button>
                </div>
                <div class="col-6">
                  <button class="btn btn-danger w-100" (click)="deleteProduct()">
                    <i class="bi bi-trash"></i> Reject
                  </button>
                </div>
              </div>
            </div>

            
            <!-- Login Prompt -->
            <div class="login-prompt" *ngIf="!currentUser">
              <div class="alert alert-warning">
                <i class="bi bi-exclamation-triangle"></i>
                <a routerLink="/login" class="alert-link">Login</a> to purchase or exchange this item
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Related Products -->
       <!-- *ngIf="showRelatedProducts()" -->
      <div class="related-products mt-5" >
        <h3 class="mb-4">Related Products</h3> 
          <div class="row">

  <div class="col-lg-3 col-md-6 mb-4"  *ngFor="let product of relatedProducts">
       <app-product-list  [product]="product" [role]="'user'"></app-product-list>
       </div>
       </div>

    <!-- Order Modal -->
    <!-- <div class="modal fade" id="orderModal" tabindex="-1">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">Place Order</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
          </div>
          <form [formGroup]="orderForm" (ngSubmit)="placeOrder()">
            <div class="modal-body">
              <div class="order-summary mb-4">
                <div class="d-flex align-items-center">
                  <img [src]="product ? getMainImage(product) : ''" class="rounded me-3" style="width: 60px; height: 60px; object-fit: cover;">
                  <div>
                    <h6 class="mb-0">{{product?.title}}</h6>
                    <p class="text-muted mb-0">\${{product?.price}}</p>
                  </div>
                </div>
              </div>

              <div class="mb-3">
                <label class="form-label">Quantity</label>
                <input type="number" class="form-control" formControlName="quantity" min="1" value="1">
              </div>

              <div class="mb-3">
                <label class="form-label">Shipping Address</label>
                <textarea class="form-control" formControlName="shippingAddress" rows="3"
                         placeholder="Enter your complete shipping address"></textarea>
              </div>

              <div class="order-total">
                <div class="d-flex justify-content-between">
                  <strong>Total: \${{calculateTotal()}}</strong>
                </div>
              </div>
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
              <button type="submit" class="btn btn-primary" [disabled]="orderForm.invalid || isPlacingOrder">
                <span *ngIf="isPlacingOrder" class="spinner-border spinner-border-sm me-2"></span>
                {{isPlacingOrder ? 'Placing Order...' : 'Place Order'}}
              </button>
            </div>
          </form>
        </div>
      </div>
    </div> -->

    <!-- Loading State -->
    <div class="container mt-5" *ngIf="isLoading">
      <div class="loading-spinner">
        <div class="spinner-border text-primary" role="status">
          <span class="visually-hidden">Loading...</span>
        </div>
      </div>
    </div>